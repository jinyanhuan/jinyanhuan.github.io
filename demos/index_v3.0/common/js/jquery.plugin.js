DateInput=(function($){function DateInput(a,b){if(typeof(b)!="object")b={};$.extend(this,DateInput.DEFAULT_OPTS,b);this.input=$(a);this.bindMethodsToObj("show","hide","hideIfClickOutside","resizeWindow","keydownHandler","selectDate");this.build();this.selectDate();this.hide()};DateInput.DEFAULT_OPTS={month_names:[decodeURIComponent("%E4%B8%80%E6%9C%88"),decodeURIComponent("%E4%BA%8C%E6%9C%88"),decodeURIComponent("%E4%B8%89%E6%9C%88"),decodeURIComponent("%E5%9B%9B%E6%9C%88"),decodeURIComponent("%E4%BA%94%E6%9C%88"),decodeURIComponent("%E5%85%AD%E6%9C%88"),decodeURIComponent("%E4%B8%83%E6%9C%88"),decodeURIComponent("%E5%85%AB%E6%9C%88"),decodeURIComponent("%E4%B9%9D%E6%9C%88"),decodeURIComponent("%E5%8D%81%E6%9C%88"),decodeURIComponent("%E5%8D%81%E4%B8%80%E6%9C%88"),decodeURIComponent("%E5%8D%81%E4%BA%8C%E6%9C%88")],short_day_names:[decodeURIComponent("%E5%91%A8%E6%97%A5"),decodeURIComponent("%E5%91%A8%E4%B8%80"),decodeURIComponent("%E5%91%A8%E4%BA%8C"),decodeURIComponent("%E5%91%A8%E4%B8%89"),decodeURIComponent("%E5%91%A8%E5%9B%9B"),decodeURIComponent("%E5%91%A8%E4%BA%94"),decodeURIComponent("%E5%91%A8%E5%85%AD")],start_of_week:1};DateInput.prototype={build:function(){var b=$('<p class="month_nav">'+'<span class="button prev no_select" title="[Page-Up]">&#171;</span>'+' <span class="month_name"></span> '+'<span class="button next no_select" title="[Page-Down]">&#187;</span>'+'</p>');this.monthNameSpan=$(".month_name",b);$(".prev",b).click(this.bindToObj(function(){this.moveMonthBy(-1)}));$(".next",b).click(this.bindToObj(function(){this.moveMonthBy(1)}));var c=$('<p class="year_nav">'+'<span class="button prev no_select" title="[Ctrl+Page-Up]">&#171;</span>'+' <span class="year_name"></span> '+'<span class="button next no_select" title="[Ctrl+Page-Down]">&#187;</span>'+'</p>');this.yearNameSpan=$(".year_name",c);$(".prev",c).click(this.bindToObj(function(){this.moveMonthBy(-12)}));$(".next",c).click(this.bindToObj(function(){this.moveMonthBy(12)}));var d=$('<div class="nav"></div>').append(b,c);var e="<table><thead><tr>";$(this.adjustDays(this.short_day_names)).each(function(){e+="<th>"+this+"</th>"});e+="</tr></thead><tbody></tbody></table>";this.dateSelector=this.rootLayers=$('<div class="date_selector"></div>').append(d,e);this.dateSelector.click(function(){var a=this;clearTimeout(a.clickTimeout);a.clickTimeout=setTimeout(function(){$(a).attr('clicked','true')},200)});$([document.body]).append(this.dateSelector);if(!-[1,]&&!window.XMLHttpRequest){this.ieframe=$('<iframe class="date_selector_ieframe" frameborder="0" src="#"></iframe>').insertBefore(this.dateSelector);this.rootLayers=this.rootLayers.add(this.ieframe);$(".button",d).mouseover(function(){$(this).addClass("hover")});$(".button",d).mouseout(function(){$(this).removeClass("hover")})};this.tbody=$("tbody",this.dateSelector);this.input.change(this.bindToObj(function(){this.selectDate()}));this.selectDate()},selectMonth:function(c){var d=this;var e=new Date(c.getFullYear(),c.getMonth(),1);if(!this.currentMonth||!(this.currentMonth.getFullYear()==e.getFullYear()&&this.currentMonth.getMonth()==e.getMonth())){this.currentMonth=e;var f=this.rangeStart(c),rangeEnd=this.rangeEnd(c);var g=this.daysBetween(f,rangeEnd);var h="";for(var i=0;i<=g;i++){var j=new Date(f.getFullYear(),f.getMonth(),f.getDate()+i,12,00);if(this.isFirstDayOfWeek(j))h+="<tr>";if(j.getMonth()==c.getMonth()){h+='<td class="selectable_day" date="'+this.dateToString(j)+'">'+j.getDate()+'</td>'}else{h+='<td class="unselected_month" date="'+this.dateToString(j)+'">'+j.getDate()+'</td>'};if(this.isLastDayOfWeek(j))h+="</tr>"};this.tbody.empty().append(h);this.monthNameSpan.empty().append(this.monthName(c));this.yearNameSpan.empty().append('<input type="text" value="'+this.currentMonth.getFullYear()+'" />');this.yearNameSpan.find('input').keyup(function(){var a=$(this);if(!isNaN(a.val())){var b=parseInt(a.val());if(b>=1000&&b<=9999)d.moveMonthBy((b-d.currentMonth.getFullYear())*12)}});this.yearNameSpan.find('input').blur(function(){var a=$(this);a.val(d.currentMonth.getFullYear())});$(".selectable_day",this.tbody).click(this.bindToObj(function(a){this.changeInput($(a.target).attr("date"))}));$("td[date='"+this.dateToString(new Date())+"']",this.tbody).addClass("today");$("td.selectable_day",this.tbody).mouseover(function(){$(this).addClass("hover")});$("td.selectable_day",this.tbody).mouseout(function(){$(this).removeClass("hover")})};$('.selected',this.tbody).removeClass("selected");$('td[date=\''+this.selectedDateString+'\']',this.tbody).addClass("selected")},selectDate:function(a){if(typeof(a)=="undefined"){a=this.stringToDate(this.input.val())};if(!a)a=new Date();this.selectedDate=a;this.selectedDateString=this.dateToString(this.selectedDate);this.selectMonth(this.selectedDate)},changeInput:function(a){this.input.val(a).change();this.hide()},show:function(){this.rootLayers.css("display","block");$([window,document.body]).click(this.hideIfClickOutside);$([window,document.body]).resize(this.resizeWindow);this.input.unbind("focus",this.show);$(document.body).keydown(this.keydownHandler);this.setPosition()},hide:function(){this.rootLayers.css("display","none");$([window,document.body]).unbind("click",this.hideIfClickOutside);$([window,document.body]).unbind("resize",this.resizeWindow);this.input.focus(this.show);$(document.body).unbind("keydown",this.keydownHandler)},hideIfClickOutside:function(a){var b=this;clearTimeout(b.hideTimeout);if(a.target!=this.input[0]){b.rootLayers.attr('clicked','false');b.hideTimeout=setTimeout(function(){if(b.rootLayers.attr('clicked')=='false')b.hide()},600)}},keydownHandler:function(a){switch(a.keyCode){case 9:case 27:this.hide();return;break;case 13:this.changeInput(this.selectedDateString);break;case 33:this.moveDateMonthBy(a.ctrlKey?-12:-1);break;case 34:this.moveDateMonthBy(a.ctrlKey?12:1);break;case 38:this.moveDateBy(-7);break;case 40:this.moveDateBy(7);break;case 37:this.moveDateBy(-1);break;case 39:this.moveDateBy(1);break;default:return}a.preventDefault()},resizeWindow:function(){this.hide();this.show()},stringToDate:function(a){var b;if(b=a.match(/^(\d{4,4})\-(\d{1,2})\-(\d{1,2})$/)){return new Date(b[1]+"/"+b[2]+"/"+b[3])}else{return null}},dateToString:function(a){return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()},setPosition:function(){var a=this.input.offset();this.rootLayers.css({top:a.top+this.input.outerHeight(),left:a.left});if(this.ieframe){this.ieframe.css({width:this.dateSelector.outerWidth(),height:this.dateSelector.outerHeight()})}},moveDateBy:function(a){var b=new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth(),this.selectedDate.getDate()+a);this.selectDate(b)},moveDateMonthBy:function(a){var b=new Date(this.selectedDate.getFullYear(),this.selectedDate.getMonth()+a,this.selectedDate.getDate());if(b.getMonth()==this.selectedDate.getMonth()+a+1){b.setDate(0)};this.selectDate(b)},moveMonthBy:function(a){var b=new Date(this.currentMonth.getFullYear(),this.currentMonth.getMonth()+a,this.currentMonth.getDate());this.selectMonth(b)},monthName:function(a){return this.month_names[a.getMonth()]},bindToObj:function(a){var b=this;return function(){return a.apply(b,arguments)}},bindMethodsToObj:function(){for(var i=0;i<arguments.length;i++){this[arguments[i]]=this.bindToObj(this[arguments[i]])}},indexFor:function(a,b){for(var i=0;i<a.length;i++){if(b==a[i])return i}},monthNum:function(a){return this.indexFor(this.month_names,a)},shortDayNum:function(a){return this.indexFor(this.short_day_names,a)},daysBetween:function(a,b){a=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate());b=Date.UTC(b.getFullYear(),b.getMonth(),b.getDate());return(b-a)/86400000},changeDayTo:function(a,b,c){var d=c*(Math.abs(b.getDay()-a-(c*7))%7);return new Date(b.getFullYear(),b.getMonth(),b.getDate()+d)},rangeStart:function(a){return this.changeDayTo(this.start_of_week,new Date(a.getFullYear(),a.getMonth()),-1)},rangeEnd:function(a){return this.changeDayTo((this.start_of_week-1)%7,new Date(a.getFullYear(),a.getMonth()+1,0),1)},isFirstDayOfWeek:function(a){return a.getDay()==this.start_of_week},isLastDayOfWeek:function(a){return a.getDay()==(this.start_of_week-1)%7},adjustDays:function(a){var b=[];for(var i=0;i<a.length;i++){b[i]=a[(i+this.start_of_week)%7]};return b}};$.fn.date_input=function(a){return this.each(function(){new DateInput(this,a)})};$.date_input={initialize:function(a){$("input.date_input").date_input(a)}};return DateInput})(jQuery);
(function($){$.fn.jCarouselLite=function(o){o=$.extend({btnPrev:null,btnNext:null,btnGo:null,mouseWheel:false,auto:null,speed:200,easing:null,vertical:false,circular:true,visible:3,start:0,scroll:1,beforeStart:null,afterEnd:null},o||{});return this.each(function(){var b=false,animCss=o.vertical?"top":"left",sizeCss=o.vertical?"height":"width";var c=$(this),ul=$("ul",c),tLi=$("li",ul),tl=tLi.size(),v=o.visible;if(o.circular){ul.prepend(tLi.slice(tl-v-1+1).clone()).append(tLi.slice(0,v).clone());o.start+=v}var f=$("li",ul),itemLength=f.size(),curr=o.start;c.css("visibility","visible");f.css({overflow:"hidden",float:o.vertical?"none":"left"});ul.css({margin:"0",padding:"0",position:"relative","list-style-type":"none","z-index":"1"});c.css({overflow:"hidden",position:"relative","z-index":"2",left:"0px"});var g=o.vertical?height(f):width(f);var h=g*itemLength;var j=g*v;f.css({width:f.width(),height:f.height()});ul.css(sizeCss,h+"px").css(animCss,-(curr*g));c.css(sizeCss,j+"px");if(o.btnPrev)$(o.btnPrev).click(function(){return go(curr-o.scroll)});if(o.btnNext)$(o.btnNext).click(function(){return go(curr+o.scroll)});if(o.btnGo)$.each(o.btnGo,function(i,a){$(a).click(function(){return go(o.circular?o.visible+i:i)})});if(o.mouseWheel&&c.mousewheel)c.mousewheel(function(e,d){return d>0?go(curr-o.scroll):go(curr+o.scroll)});if(o.auto)setInterval(function(){go(curr+o.scroll)},o.auto+o.speed);function vis(){return f.slice(curr).slice(0,v)};function go(a){if(!b){if(o.beforeStart)o.beforeStart.call(this,vis());if(o.circular){if(a<=o.start-v-1){ul.css(animCss,-((itemLength-(v*2))*g)+"px");curr=a==o.start-v-1?itemLength-(v*2)-1:itemLength-(v*2)-o.scroll}else if(a>=itemLength-v+1){ul.css(animCss,-((v)*g)+"px");curr=a==itemLength-v+1?v+1:v+o.scroll}else curr=a}else{if(a<0||a>itemLength-v)return;else curr=a}b=true;ul.animate(animCss=="left"?{left:-(curr*g)}:{top:-(curr*g)},o.speed,o.easing,function(){if(o.afterEnd)o.afterEnd.call(this,vis());b=false});if(!o.circular){$(o.btnPrev+","+o.btnNext).removeClass("disabled");$((curr-o.scroll<0&&o.btnPrev)||(curr+o.scroll>itemLength-v&&o.btnNext)||[]).addClass("disabled")}}return false}})};function css(a,b){return parseInt($.css(a[0],b))||0};function width(a){return a[0].offsetWidth+css(a,'marginLeft')+css(a,'marginRight')};function height(a){return a[0].offsetHeight+css(a,'marginTop')+css(a,'marginBottom')}})(jQuery);
(function(a,b,c,d){var e=a(b);a.fn.lazyload=function(c){function i(){var b=0;f.each(function(){var c=a(this);if(h.skip_invisible&&!c.is(":visible"))return;if(!a.abovethetop(this,h)&&!a.leftofbegin(this,h))if(!a.belowthefold(this,h)&&!a.rightoffold(this,h))c.trigger("appear"),b=0;else if(++b>h.failure_limit)return!1})}var f=this,g,h={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null};return c&&(d!==c.failurelimit&&(c.failure_limit=c.failurelimit,delete c.failurelimit),d!==c.effectspeed&&(c.effect_speed=c.effectspeed,delete c.effectspeed),a.extend(h,c)),g=h.container===d||h.container===b?e:a(h.container),0===h.event.indexOf("scroll")&&g.bind(h.event,function(a){return i()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,c.one("appear",function(){if(!this.loaded){if(h.appear){var d=f.length;h.appear.call(b,d,h)}a("<img />").bind("load",function(){c.hide().attr("src",c.data(h.data_attribute))[h.effect](h.effect_speed),b.loaded=!0;var d=a.grep(f,function(a){return!a.loaded});f=a(d);if(h.load){var e=f.length;h.load.call(b,e,h)}}).attr("src",c.data(h.data_attribute))}}),0!==h.event.indexOf("scroll")&&c.bind(h.event,function(a){b.loaded||c.trigger("appear")})}),e.bind("resize",function(a){i()}),/iphone|ipod|ipad.*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent.persisted&&f.each(function(){a(this).trigger("appear")})}),a(b).load(function(){i()}),this},a.belowthefold=function(c,f){var g;return f.container===d||f.container===b?g=e.height()+e.scrollTop():g=a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return f.container===d||f.container===b?g=e.width()+e.scrollLeft():g=a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return f.container===d||f.container===b?g=e.scrollTop():g=a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return f.container===d||f.container===b?g=e.scrollLeft():g=a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!a.rightoffold(b,c)&&!a.leftofbegin(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})})(jQuery,window,document);
(function(e,t,n){"use strict";var r=t.event,i;r.special.smartresize={setup:function(){t(this).bind("resize",r.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",r.special.smartresize.handler)},handler:function(e,t){var n=this,s=arguments;e.type="smartresize",i&&clearTimeout(i),i=setTimeout(function(){r.dispatch.apply(n,s)},t==="execAsap"?0:100)}},t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},t.Mason=function(e,n){this.element=t(n),this._create(e),this._init()},t.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},t.Mason.prototype={_filterFindBricks:function(e){var t=this.options.itemSelector;return t?e.filter(t).add(e.find(t)):e},_getBricks:function(e){var t=this._filterFindBricks(e).css({position:"absolute"}).addClass("masonry-brick");return t},_create:function(n){this.options=t.extend(!0,{},t.Mason.settings,n),this.styleQueue=[];var r=this.element[0].style;this.originalStyle={height:r.height||""};var i=this.options.containerStyle;for(var s in i)this.originalStyle[s]=r[s]||"";this.element.css(i),this.horizontalDirection=this.options.isRTL?"right":"left";var o=this.element.css("padding-"+this.horizontalDirection),u=this.element.css("padding-top");this.offset={x:o?parseInt(o,10):0,y:u?parseInt(u,10):0},this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth=="function";var a=this;setTimeout(function(){a.element.addClass("masonry")},0),this.options.isResizable&&t(e).bind("smartresize.masonry",function(){a.resize()}),this.reloadItems()},_init:function(e){this._getColumns(),this._reLayout(e)},option:function(e,n){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))},layout:function(e,t){for(var n=0,r=e.length;n<r;n++)this._placeBrick(e[n]);var i={};i.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var s=0;n=this.cols;while(--n){if(this.colYs[n]!==0)break;s++}i.width=(this.cols-s)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:i});var o=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",u=this.options.animationOptions,a;for(n=0,r=this.styleQueue.length;n<r;n++)a=this.styleQueue[n],a.$el[o](a.style,u);this.styleQueue=[],t&&t.call(e),this.isLaidOut=!0},_getColumns:function(){var e=this.options.isFitWidth?this.element.parent():this.element,t=e.width();this.columnWidth=this.isFluid?this.options.columnWidth(t):this.options.columnWidth||this.$bricks.outerWidth(!0)||t,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((t+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(e){var n=t(e),r,i,s,o,u;r=Math.ceil(n.outerWidth(!0)/this.columnWidth),r=Math.min(r,this.cols);if(r===1)s=this.colYs;else{i=this.cols+1-r,s=[];for(u=0;u<i;u++)o=this.colYs.slice(u,u+r),s[u]=Math.max.apply(Math,o)}var a=Math.min.apply(Math,s),f=0;for(var l=0,c=s.length;l<c;l++)if(s[l]===a){f=l;break}var h={top:a+this.offset.y};h[this.horizontalDirection]=this.columnWidth*f+this.offset.x,this.styleQueue.push({$el:n,style:h});var p=a+n.outerHeight(!0),d=this.cols+1-c;for(l=0;l<d;l++)this.colYs[f+l]=p},resize:function(){var e=this.cols;this._getColumns(),(this.isFluid||this.cols!==e)&&this._reLayout()},_reLayout:function(e){var t=this.cols;this.colYs=[];while(t--)this.colYs.push(0);this.layout(this.$bricks,e)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(e){this.reloadItems(),this._init(e)},appended:function(e,t,n){if(t){this._filterFindBricks(e).css({top:this.element.height()});var r=this;setTimeout(function(){r._appended(e,n)},1)}else this._appended(e,n)},_appended:function(e,t){var n=this._getBricks(e);this.$bricks=this.$bricks.add(n),this.layout(n,t)},remove:function(e){this.$bricks=this.$bricks.not(e),e.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var n=this.element[0].style;for(var r in this.originalStyle)n[r]=this.originalStyle[r];this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),t(e).unbind(".masonry")}},t.fn.imagesLoaded=function(e){function u(){e.call(n,r)}function a(e){var n=e.target;n.src!==s&&t.inArray(n,o)===-1&&(o.push(n),--i<=0&&(setTimeout(u),r.unbind(".imagesLoaded",a)))}var n=this,r=n.find("img").add(n.filter("img")),i=r.length,s="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",o=[];return i||u(),r.bind("load.imagesLoaded error.imagesLoaded",a).each(function(){var e=this.src;this.src=s,this.src=e}),n};var s=function(t){e.console&&e.console.error(t)};t.fn.masonry=function(e){if(typeof e=="string"){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var r=t.data(this,"masonry");if(!r){s("cannot call methods on masonry prior to initialization; attempted to call method '"+e+"'");return}if(!t.isFunction(r[e])||e.charAt(0)==="_"){s("no such method '"+e+"' for masonry instance");return}r[e].apply(r,n)})}else this.each(function(){var n=t.data(this,"masonry");n?(n.option(e||{}),n._init()):t.data(this,"masonry",new t.Mason(e,this))});return this}})(window,jQuery);
;(function($){$.tiny=$.tiny||{};$.tiny.scrollbar={options:{axis:'y',wheel:40,scroll:true,lockscroll:true,size:'auto',sizethumb:'auto',invertscroll:false}};$.fn.tinyscrollbar=function(params){var options=$.extend({},$.tiny.scrollbar.options,params);this.each(function(){$(this).data('tsb',new Scrollbar($(this),options))});return this};$.fn.tinyscrollbar_update=function(sScroll){return $(this).data('tsb').update(sScroll)};function Scrollbar(root,options){var oSelf=this,oWrapper=root,oViewport={obj:$('.viewport',root)},oContent={obj:$('.overview',root)},oScrollbar={obj:$('.scrollbar',root)},oTrack={obj:$('.track',oScrollbar.obj)},oThumb={obj:$('.thumb',oScrollbar.obj)},sAxis=options.axis==='x',sDirection=sAxis?'left':'top',sSize=sAxis?'Width':'Height',iScroll=0,iPosition={start:0,now:0},iMouse={},touchEvents='ontouchstart'in document.documentElement;function initialize(){oSelf.update();setEvents();return oSelf};this.update=function(sScroll){oViewport[options.axis]=oViewport.obj[0]['offset'+sSize];oContent[options.axis]=oContent.obj[0]['scroll'+sSize];oContent.ratio=oViewport[options.axis]/oContent[options.axis];oScrollbar.obj.toggleClass('disable',oContent.ratio>=1);oTrack[options.axis]=options.size==='auto'?oViewport[options.axis]:options.size;oThumb[options.axis]=Math.min(oTrack[options.axis],Math.max(0,(options.sizethumb==='auto'?(oTrack[options.axis]*oContent.ratio):options.sizethumb)));oScrollbar.ratio=options.sizethumb==='auto'?(oContent[options.axis]/ oTrack[ options.axis ] ) : ( oContent[ options.axis ] - oViewport[ options.axis ] ) /(oTrack[options.axis]-oThumb[options.axis]);iScroll=(sScroll==='relative'&&oContent.ratio<=1)?Math.min((oContent[options.axis]-oViewport[options.axis]),Math.max(0,iScroll)):0;iScroll=(sScroll==='bottom'&&oContent.ratio<=1)?(oContent[options.axis]-oViewport[options.axis]):isNaN(parseInt(sScroll,10))?iScroll:parseInt(sScroll,10);setSize()};function setSize(){var sCssSize=sSize.toLowerCase();oThumb.obj.css(sDirection,iScroll/oScrollbar.ratio);oContent.obj.css(sDirection,-iScroll);iMouse.start=oThumb.obj.offset()[sDirection];oScrollbar.obj.css(sCssSize,oTrack[options.axis]);oTrack.obj.css(sCssSize,oTrack[options.axis]);oThumb.obj.css(sCssSize,oThumb[options.axis])};function setEvents(){if(!touchEvents){oThumb.obj.bind('mousedown',start);oTrack.obj.bind('mouseup',drag)}else{oViewport.obj[0].ontouchstart=function(event){if(1===event.touches.length){start(event.touches[0]);event.stopPropagation()}}};if(options.scroll&&window.addEventListener){oWrapper[0].addEventListener('DOMMouseScroll',wheel,false);oWrapper[0].addEventListener('mousewheel',wheel,false);oWrapper[0].addEventListener('MozMousePixelScroll',function(event){event.preventDefault()},false)}else if(options.scroll){oWrapper[0].onmousewheel=wheel}};function start(event){$("body").addClass("no_select");var oThumbDir=parseInt(oThumb.obj.css(sDirection),10);iMouse.start=sAxis?event.pageX:event.pageY;iPosition.start=oThumbDir=='auto'?0:oThumbDir;if(!touchEvents){$(document).bind('mousemove',drag);$(document).bind('mouseup',end);oThumb.obj.bind('mouseup',end)}else{document.ontouchmove=function(event){event.preventDefault();drag(event.touches[0])};document.ontouchend=end}};function wheel(event){if(oContent.ratio<1){var oEvent=event||window.event,iDelta=oEvent.wheelDelta?oEvent.wheelDelta/ 120 : -oEvent.detail /3;iScroll-=iDelta*options.wheel;iScroll=Math.min((oContent[options.axis]-oViewport[options.axis]),Math.max(0,iScroll));oThumb.obj.css(sDirection,iScroll/oScrollbar.ratio);oContent.obj.css(sDirection,-iScroll);if(options.lockscroll||(iScroll!==(oContent[options.axis]-oViewport[options.axis])&&iScroll!==0)){oEvent=$.event.fix(oEvent);oEvent.preventDefault()}}};function drag(event){if(oContent.ratio<1){if(options.invertscroll&&touchEvents){iPosition.now=Math.min((oTrack[options.axis]-oThumb[options.axis]),Math.max(0,(iPosition.start+(iMouse.start-(sAxis?event.pageX:event.pageY)))))}else{iPosition.now=Math.min((oTrack[options.axis]-oThumb[options.axis]),Math.max(0,(iPosition.start+((sAxis?event.pageX:event.pageY)-iMouse.start))))};iScroll=iPosition.now*oScrollbar.ratio;oContent.obj.css(sDirection,-iScroll);oThumb.obj.css(sDirection,iPosition.now)}};function end(){$("body").removeClass("no_select");$(document).unbind('mousemove',drag);$(document).unbind('mouseup',end);oThumb.obj.unbind('mouseup',end);document.ontouchmove=document.ontouchend=null};return initialize()}}(jQuery));

(function($){var body=$(document.body);var window=$(window);var jqzoompluging_disabled=false;$.fn.jqzoom=function(options){return this.each(function(){var node=this.nodeName.toLowerCase();if(node=='a'){new jqzoom(this,options)}})};jqzoom=function(el,options){var api=null;api=$(el).data("jqzoom");if(api)return api;var obj=this;var settings=$.extend({},$.jqzoom.defaults,options||{});obj.el=el;el.rel=$(el).attr('rel');el.zoom_active=false;el.zoom_disabled=false;el.largeimageloading=false;el.largeimageloaded=false;el.scale={};el.timer=null;el.mousepos={};el.mouseDown=false;$(el).css({'outline-style':'none','text-decoration':'none'});var img=$("img:eq(0)",el);el.title=$(el).attr('title');el.imagetitle=img.attr('title');var zoomtitle=($.trim(el.title).length>0)?el.title:el.imagetitle;var smallimage=new Smallimage(img);var lens=new Lens();var stage=new Stage();var largeimage=new Largeimage();var loader=new Loader();$(el).bind('click',function(e){e.preventDefault();return false});var zoomtypes=['standard','drag','innerzoom','reverse'];if($.inArray($.trim(settings.zoomType),zoomtypes)<0){settings.zoomType='standard'};$.extend(obj,{create:function(){if($(".imgzoom_pad",el).length==0){el.imgzoom_pad=$('<div/>').addClass('imgzoom_pad');img.wrap(el.imgzoom_pad)};if($(".imgzoom_pup",el).length==0){lens.append()};if($(".imgzoom_window",el).length==0){stage.append()};if($(".imgzoom_preload",el).length==0){loader.append()};if(settings.preloadImages||settings.zoomType=='drag'||settings.alwaysOn){obj.load()};obj.init()},init:function(){if(settings.zoomType=='drag'){$(".imgzoom_pad",el).mousedown(function(){el.mouseDown=true});$(".imgzoom_pad",el).mouseup(function(){el.mouseDown=false});document.body.ondragstart=function(){return false};$(".imgzoom_pad",el).css({cursor:'default'});$(".imgzoom_pup",el).css({cursor:'move'})};if(settings.zoomType=='innerzoom'){$(".imgzoom_wrapper",el).css({cursor:'crosshair'})};$(".imgzoom_pad",el).bind('mouseenter mouseover',function(event){img.attr('title','');$(el).attr('title','');el.zoom_active=true;smallimage.fetchdata();if(el.largeimageloaded){obj.activate(event)}else{obj.load()}});$(".imgzoom_pad",el).bind('mouseleave',function(event){obj.deactivate()});$(".imgzoom_pad",el).bind('mousemove',function(e){if(e.pageX>smallimage.pos.r||e.pageX<smallimage.pos.l||e.pageY<smallimage.pos.t||e.pageY>smallimage.pos.b){lens.setcenter();return false};el.zoom_active=true;if(el.largeimageloaded&&!$('.imgzoom_window',el).is(':visible')){obj.activate(e)};if(el.largeimageloaded&&(settings.zoomType!='drag'||(settings.zoomType=='drag'&&el.mouseDown))){lens.setposition(e)}});var thumb_preload=new Array();var i=0;var thumblist=new Array();thumblist=$('a').filter(function(){var regex=new RegExp("gallery[\\s]*:[\\s]*'"+$.trim(el.rel)+"'","i");var rel=$(this).attr('rel');if(regex.test(rel)){return this}});if(thumblist.length>0){var first=thumblist.splice(0,1);thumblist.push(first)};thumblist.each(function(){if(settings.preloadImages){var thumb_options=$.extend({},eval("("+$.trim($(this).attr('rel'))+")"));thumb_preload[i]=new Image();thumb_preload[i].src=thumb_options.largeimage;i++};$(this).click(function(e){thumblist.each(function(){$(this).removeClass('selected')});e.preventDefault();obj.swapimage(this);return false})})},load:function(){if(el.largeimageloaded==false&&el.largeimageloading==false){var url=$(el).attr('href');el.largeimageloading=true;largeimage.loadimage(url)}},activate:function(e){clearTimeout(el.timer);lens.show();stage.show()},deactivate:function(e){switch(settings.zoomType){case'drag':break;default:img.attr('title',el.imagetitle);$(el).attr('title',el.title);if(settings.alwaysOn){lens.setcenter()}else{stage.hide();lens.hide()};break};el.zoom_active=false},swapimage:function(link){el.largeimageloading=false;el.largeimageloaded=false;var options=new Object();options=$.extend({},eval("("+$.trim($(link).attr('rel'))+")"));if(options.smallimage&&options.largeimage){var smallimage=options.smallimage;var largeimage=options.largeimage;$(link).addClass('selected');$(el).attr('href',largeimage);img.attr('src',smallimage);lens.hide();stage.hide();obj.load()}else{alert('ERROR :: Missing parameter for largeimage or smallimage.');throw'ERROR :: Missing parameter for largeimage or smallimage.'};return false}});if(img[0].complete){smallimage.fetchdata();if($(".imgzoom_pad",el).length==0)obj.create()};function Smallimage(image){var $obj=this;this.node=image[0];this.findborder=function(){var bordertop=0;bordertop=image.css('border-top-width');btop='';var borderleft=0;borderleft=image.css('border-left-width');bleft='';if(bordertop){for(i=0;i<3;i++){var x=[];x=bordertop.substr(i,1);if(isNaN(x)==false){btop=btop+''+bordertop.substr(i,1)}else{break}}};if(borderleft){for(i=0;i<3;i++){if(!isNaN(borderleft.substr(i,1))){bleft=bleft+borderleft.substr(i,1)}else{break}}};$obj.btop=(btop.length>0)?eval(btop):0;$obj.bleft=(bleft.length>0)?eval(bleft):0};this.fetchdata=function(){$obj.findborder();$obj.w=image.width();$obj.h=image.height();$obj.ow=image.outerWidth();$obj.oh=image.outerHeight();if(img.attr('jqzoom_outerwidth'))$obj.ow=parseInt(img.attr('jqzoom_outerwidth'));if(img.attr('jqzoom_outerheight'))$obj.oh=parseInt(img.attr('jqzoom_outerheight'));$obj.pos=image.offset();$obj.pos.l=image.offset().left+$obj.bleft;$obj.pos.t=image.offset().top+$obj.btop;$obj.pos.r=$obj.w+$obj.pos.l;$obj.pos.b=$obj.h+$obj.pos.t;$obj.rightlimit=image.offset().left+$obj.ow;$obj.bottomlimit=image.offset().top+$obj.oh};this.node.onerror=function(){alert('Problems while loading image.');throw'Problems while loading image.'};this.node.onload=function(){$obj.fetchdata();if($(".imgzoom_pad",el).length==0)obj.create()};return $obj};function Loader(){var $obj=this;this.append=function(){this.node=$('<div/>').addClass('imgzoom_preload').css('visibility','hidden').html(settings.preloadText);$('.imgzoom_pad',el).append(this.node)};this.show=function(){this.node.top=(smallimage.oh-this.node.height())/2;this.node.left=(smallimage.ow-this.node.width())/2;this.node.css({top:this.node.top,left:this.node.left,position:'absolute',visibility:'visible'})};this.hide=function(){this.node.css('visibility','hidden')};return this};function Lens(){var $obj=this;this.node=$('<div/>').addClass('imgzoom_pup');this.append=function(){$('.imgzoom_pad',el).append($(this.node).hide());if(settings.zoomType=='reverse'){this.image=new Image();this.image.onload=function(){$obj.imageWidth=this.width;$obj.imageHeight=this.height;if($obj.imageWidth>$obj.imageHeight){this.style.width='338px';this.style.height='253px'};if($obj.imageWidth==$obj.imageHeight){this.style.width='338px';this.style.height='338px'};if($obj.imageWidth<$obj.imageHeight){this.style.width='253px';this.style.height='338px'}};this.image.src=smallimage.node.src;$(this.node).empty().append(this.image);}};this.setdimensions=function(){this.node.w=(parseInt((settings.zoomWidth)/ el.scale.x) > smallimage.w) ? smallimage.w : parseInt((settings.zoomWidth) /el.scale.x);this.node.h=(parseInt((settings.zoomHeight)/ el.scale.y) > smallimage.h) ? smallimage.h : parseInt((settings.zoomHeight) /el.scale.y);this.node.top=(smallimage.oh-this.node.h-2)/2;this.node.left=(smallimage.ow-this.node.w-2)/2;this.node.css({top:0,left:0,width:this.node.w+'px',height:this.node.h+'px',position:'absolute',display:'none',borderWidth:1+'px'});if(settings.zoomType=='reverse'){this.image.src=smallimage.node.src;$(this.node).css({'opacity':1});$(this.image).css({position:'absolute',left:-(this.node.left+1-smallimage.bleft)+'px',top:-(this.node.top+1-smallimage.btop)+'px'})}};this.setcenter=function(){this.node.top=(smallimage.oh-this.node.h-2)/2;this.node.left=(smallimage.ow-this.node.w-2)/2;this.node.css({top:this.node.top,left:this.node.left});if(settings.zoomType=='reverse'){$(this.image).css({position:'absolute',left:-(this.node.left+1-smallimage.bleft)+'px',top:-(this.node.top+1-smallimage.btop)+'px'})};largeimage.setposition()};this.setposition=function(e){el.mousepos.x=e.pageX;el.mousepos.y=e.pageY;var lensleft=0;var lenstop=0;function overleft(lens){return el.mousepos.x-(lens.w)/2<smallimage.pos.l};function overright(lens){return el.mousepos.x+(lens.w)/2>smallimage.pos.r};function overtop(lens){return el.mousepos.y-(lens.h)/2<smallimage.pos.t};function overbottom(lens){return el.mousepos.y+(lens.h)/2>smallimage.pos.b};lensleft=el.mousepos.x+smallimage.bleft-smallimage.pos.l-(this.node.w+2)/2;lenstop=el.mousepos.y+smallimage.btop-smallimage.pos.t-(this.node.h+2)/2;if(overleft(this.node)){lensleft=smallimage.bleft-1}else if(overright(this.node)){lensleft=smallimage.w+smallimage.bleft-this.node.w-1};if(overtop(this.node)){lenstop=smallimage.btop-1}else if(overbottom(this.node)){lenstop=smallimage.h+smallimage.btop-this.node.h-1};this.node.left=lensleft;this.node.top=lenstop;this.node.css({'left':lensleft+'px','top':lenstop+'px'});if(settings.zoomType=='reverse'){$(this.image).css({position:'absolute',left:-(this.node.left+1-smallimage.bleft)+'px',top:-(this.node.top+1-smallimage.btop)+'px'})};largeimage.setposition()};this.hide=function(){img.css({'opacity':1});this.node.hide()};this.show=function(){if(settings.zoomType!='innerzoom'&&(settings.lens||settings.zoomType=='drag')){this.node.show()};if(settings.zoomType=='reverse'){img.css({'opacity':settings.imageOpacity})}};this.getoffset=function(){var o={};o.left=$obj.node.left;o.top=$obj.node.top;return o};return this};function Stage(){var $obj=this;this.node=$("<div class='imgzoom_window'><div class='imgzoom_wrapper'><div class='imgzoom_wrapper_title'></div><div class='imgzoom_wrapper_image'></div></div></div>");this.ieframe=$('<iframe class="imgzoom_iframe" src="javascript:\'\';" marginwidth="0" marginheight="0" align="bottom" scrolling="no" frameborder="0" ></iframe>');this.setposition=function(){this.node.leftpos=0;this.node.toppos=0;if(settings.zoomType!='innerzoom'){switch(settings.position){case"left":this.node.leftpos=0-settings.zoomWidth-Math.abs(settings.xOffset);this.node.toppos=Math.abs(settings.yOffset);break;case"top":this.node.leftpos=Math.abs(settings.xOffset);this.node.toppos=0-settings.zoomHeight-Math.abs(settings.yOffset);break;case"bottom":this.node.leftpos=Math.abs(settings.xOffset);this.node.toppos=smallimage.oh+Math.abs(settings.yOffset);break;default:this.node.leftpos=smallimage.ow+Math.abs(settings.xOffset);this.node.toppos=Math.abs(settings.yOffset);break}};this.node.css({'left':this.node.leftpos+'px','top':this.node.toppos+'px'});return this};this.append=function(){if(!img.attr('jqzoom_parallel'))$('.imgzoom_pad',el).append(this.node);else $('.imgzoom_pad',el).parent().append(this.node);this.node.css({position:'absolute',display:'none',zIndex:5001});if(settings.zoomType=='innerzoom'){this.node.css({cursor:'default'});var thickness=(smallimage.bleft==0)?1:smallimage.bleft;$('.imgzoom_wrapper',this.node).css({width:smallimage.w+'px',borderWidth:thickness+'px'});$('.imgzoom_wrapper_image',this.node).css({width:'100%',height:smallimage.h+'px'});$('.imgzoom_wrapper_title',this.node).css({width:'100%',position:'absolute'})}else{$('.imgzoom_wrapper',this.node).css({width:Math.round(settings.zoomWidth)+'px'});$('.imgzoom_wrapper_image',this.node).css({width:'100%',height:Math.round(settings.zoomHeight)+'px'});$('.imgzoom_wrapper_title',this.node).css({width:'100%',position:'absolute'})};$('.imgzoom_wrapper_title',this.node).hide();if(settings.title&&zoomtitle.length>0){$('.imgzoom_wrapper_title',this.node).html(zoomtitle).show()};$obj.setposition()};this.hide=function(){switch(settings.hideEffect){case'fadeout':this.node.fadeOut(settings.fadeoutSpeed,function(){});break;default:this.node.hide();break};this.ieframe.hide()};this.show=function(){switch(settings.showEffect){case'fadein':this.node.fadeIn();this.node.fadeIn(settings.fadeinSpeed,function(){});break;default:this.node.show();break};var isIE6=!-[1,]&&!window.XMLHttpRequest;if(isIE6&&settings.zoomType!='innerzoom'){this.ieframe.width=this.node.width();this.ieframe.height=this.node.height();this.ieframe.left=this.node.leftpos;this.ieframe.top=this.node.toppos;this.ieframe.css({display:'block',position:"absolute",left:this.ieframe.left,top:this.ieframe.top,zIndex:99,width:this.ieframe.width+'px',height:this.ieframe.height+'px'});$('.imgzoom_pad',el).append(this.ieframe);this.ieframe.show()}}};function Largeimage(){var $obj=this;this.node=new Image();this.node.onerror=function(){alert('Problems while loading the big image.');throw'Problems while loading the big image.'};this.node.onload=function(){$obj.fetchdata();loader.hide();el.largeimageloading=false;el.largeimageloaded=true;if(settings.zoomType=='drag'||settings.alwaysOn){lens.show();stage.show();lens.setcenter()}};this.loadimage=function(url){loader.show();this.url=url;this.node.style.position='absolute';this.node.style.border='0px';this.node.style.display='none';this.node.style.left='-5000px';this.node.style.top='0px';document.body.appendChild(this.node);this.node.src=url+'?random='+Math.ceil(Math.random()*100000);};this.fetchdata=function(){var image=$(this.node);var scale={};this.node.style.display='block';$obj.w=image.width();$obj.h=image.height();$obj.pos=image.offset();$obj.pos.l=image.offset().left;$obj.pos.t=image.offset().top;$obj.pos.r=$obj.w+$obj.pos.l;$obj.pos.b=$obj.h+$obj.pos.t;scale.x=($obj.w/smallimage.w);scale.y=($obj.h/smallimage.h);el.scale=scale;document.body.removeChild(this.node);$('.imgzoom_wrapper_image',el).empty().append(this.node);lens.setdimensions()};this.setposition=function(){var left=-el.scale.x*(lens.getoffset().left-smallimage.bleft+1);var top=-el.scale.y*(lens.getoffset().top-smallimage.btop+1);$(this.node).css({'left':left+'px','top':top+'px'})};return this};$(el).data("jqzoom",obj)};$.jqzoom={defaults:{zoomType:'standard',zoomWidth:300,zoomHeight:300,xOffset:10,yOffset:0,position:"right",preloadImages:true,preloadText:'Loading zoom',title:false,lens:true,imageOpacity:0.4,alwaysOn:false,showEffect:'show',hideEffect:'hide',fadeinSpeed:'slow',fadeoutSpeed:'2000'},disable:function(el){var api=$(el).data('jqzoom');api.disable();return false},enable:function(el){var api=$(el).data('jqzoom');api.enable();return false},disableAll:function(el){jqzoompluging_disabled=true},enableAll:function(el){jqzoompluging_disabled=false}}})(jQuery);
